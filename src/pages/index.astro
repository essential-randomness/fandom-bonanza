---
import React from "react";
import Post from "../components/Post.tsx"
import "@bobaboard/boba-editor/dist/main.css";
import { Debug } from 'astro/components';

const response = await fetch('https://backend-dot-bobaboard.uc.r.appspot.com/threads/1a80732d-82ae-4173-b5c5-7d350e9b7caa');

const data = await response.json();
const posts = data.posts.map(post => ({id: post.id, content: post.content, author: post.secret_identity.name}));

---
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width" />
		<script
			async
			src="https://platform.twitter.com/widgets.js"
			charset="utf-8"
			defer
		></script>
		<title>Welcome to my twisted mind</title>
	</head>
	<body>
		<h1>Welcome to my twisted mind</h1>
		{posts.filter((_, i) => i == 3 || i == 4).map((post) => {
			// TODO: some astro bug are stopping implementation. See:
			// https://github.com/withastro/astro/issues/2294
			// and (possibly) https://github.com/withastro/astro/issues/2574
			return <div><h1>{post.id}</h1>{<Post key={post.id} initialText={JSON.parse(post.content)} client:only />}</div>;
		})}
	</body>
</html>